## Pairwise Sequence Alignment using EMBOSS Needle on GCP

This document outlines a plan to perform pairwise sequence alignment on a FASTA file using the EMBOSS Needle tool within a Google Cloud Platform (GCP) High Performance Computing (HPC) environment.  The alignment will assess the similarity between sequences in the provided FASTA file.


**1. Research Question:**

To assess the similarity between sequences within a given FASTA file using pairwise sequence alignment.


**2. Methodology:**

The analysis will utilize the EMBOSS Needle tool, a widely used bioinformatics program for sequence alignment.  The workflow involves:

* **Data Preparation:** A FASTA file (`pairwise_input.fasta`) containing the sequences to be aligned will be prepared.
* **Environment Setup:** A GCP HPC environment will be created using Pulumi, leveraging a custom image built with Packer to ensure a consistent and reproducible environment pre-configured with necessary dependencies. This includes:
    * Ubuntu 22.04 LTS base image.
    * Spack package manager for streamlined installation of EMBOSS.
    * EMBOSS Needle tool.
* **Alignment Execution:** The `needleall` command from EMBOSS will be executed on the GCP instance, performing all pairwise comparisons within the input FASTA file.  Specific parameters (`-gapopen`, `-gapextend`, etc.) are defined to control the alignment process.
* **Result Retrieval:** The alignment results will be written to an output file (`pairwise_output.txt`) stored in a GCP Cloud Storage bucket.

**3.  GCP Deployment Configuration (Pulumi YAML):**

The following Pulumi YAML configuration defines the infrastructure and deployment process:

```yaml
blueprint_name: hpc-sequence-alignment

vars:
  project_id:  ## Set GCP Project ID Here ##
  bucket_name: ## Set your bucket name prefix here ##
  deployment_name: hpc-sequence-alignment
  region: us-central1
  zone: us-central1-a
  zone_list: [us-central1-a]
  new_image_family: sequence-alignment-image
  instance_image_custom: true
  disk_size_gb: 100

# ... (Rest of the YAML configuration remains the same as provided) ...
```

This configuration outlines the creation of a virtual machine (VM) instance with the necessary software pre-installed.  The `startup.sh` script automatically executes the `needleall` command upon instance startup.  The input FASTA file is uploaded to a GCP storage bucket and mounted to the VM.  Results are stored in the same bucket for easy retrieval.


**4. Input FASTA File (`pairwise_input.fasta`):**

```
>Sequence_1
ATGCTGATCGTAGCTGACTGAAAAATGGGTTGGTTGGTG
>Sequence_2
ATG--GATCGTAGCTGACTTAAAAATGGGTTGGTTGGTG
>Sequence_3
ATG--GATCGTAGCTGACTTAA---TGGGTTGGTTGGTG
```


**5.  Expected Output:**

The output file (`pairwise_output.txt`) will contain the pairwise alignments generated by `needleall`, formatted according to the specified parameters (`-aformat3=pair`, `-awidth3=100`).  This output will show the aligned sequences, along with scores indicating their similarity.

**6.  Further Considerations:**

* **Scalability:** This configuration utilizes a single VM. For larger datasets, consider scaling to a cluster of VMs for parallel processing.
* **Parameter Optimization:** The gap opening and extension penalties (`-gapopen`, `-gapextend`) can be adjusted based on the specific sequences and alignment goals.
* **Error Handling:**  More robust error handling can be added to the startup script to manage potential issues during execution.

This document provides a complete overview of the planned analysis, the chosen methodology, and the infrastructure required for execution.  The detailed Pulumi YAML configuration ensures reproducibility and facilitates easy deployment on GCP.
